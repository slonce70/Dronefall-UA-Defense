<!doctype html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dronefall: UA Defense</title>
    <meta name="theme-color" content="#0b0b0b" />
    <!-- CSP: allow inline styles for dev tooling (Vite injects <style> tags). For PROD, prefer server header without 'unsafe-inline'. -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; base-uri 'self'; object-src 'none'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob:; font-src 'self' data:; media-src 'self' blob:; connect-src 'self' ws:; manifest-src 'self'"> 
    <!-- Критичні стилі перенесено у style.css для суворішого CSP -->
    <!-- Preload шпалер титульного екрану для швидшого першого кадру -->
    <link rel="preload" as="image" href="/assets/wallpaper.png" fetchpriority="high" />
    <link rel="manifest" href="/manifest.webmanifest" />
    <link rel="icon" type="image/png" href="/assets/favicon.png" />
    <!-- Підключаємо CSS одразу, без JS‑інʼєкції, щоб уникати миготіння в dev -->
    <link rel="stylesheet" href="/style.css" />
    <!-- Leaflet підключається через NPM (див. src/main.js) -->
  </head>
  <body>
    <div id="map"></div>

    <div id="controlPanel">
      <span id="dragHandle"></span>
      <div class="panel-body">
        <span id="money">💶 3500</span>
        <span id="waveDisplay">🌊 0</span>
        <span id="scoreDisplay">🎯 0</span>
      </div>
    </div>

    <div id="soundButtonContainer">
      <div id="speedButtons" role="group" aria-label="Керування швидкістю">
        <button id="speed1x" class="speed-button active" aria-label="Швидкість 1x">1x</button>
        <button id="speed2x" class="speed-button" aria-label="Швидкість 2x">2x</button>
        <button id="speed3x" class="speed-button" aria-label="Швидкість 3x">3x</button>
      </div>
      <div id="settingsButtons">
        <button id="pauseButton" aria-label="Пауза">⏸️</button>
        <button id="soundButton" aria-label="Перемкнути звук">🔊</button>
      </div>
    </div>

    <audio id="bgMusic" loop src="assets/music.mp3" playsinline preload="none"></audio>
    <audio id="alarmSound" src="assets/alarm.mp3" playsinline preload="auto"></audio>

    <div id="preMenu">
      <div class="overlay"></div>
      <div class="preMenu-content" role="dialog" aria-modal="true" aria-labelledby="gameTitle">
        <span class="ai-note"
          >🧠 Ця гра створена за допомогою штучного інтелекту.<br />© 2025 DroneFall v.1.8.22</span
        >
        <h1 id="gameTitle">Dronefall: UA Defense</h1>
        <div class="button-group compact">
          <button id="startBtn" class="mode-button small">
            Режим:<br />🔄️ Кругова<br />оборона
          </button>
          <button id="startRightBtn" class="mode-button small">
            Режим:<br />➡️ Проти<br />росії
          </button>
        </div>
        <div class="button-group compact">
          <button id="startHardcoreBtn" class="mode-button small">Режим:<br />🔥 Хардкор</button>

          <button id="startCrtv" class="mode-button small">⌛ Незабаром...</button>
        </div>

        <div id="legend">
          💶 Гроші - для покупки ППО.<br />
          🌊 Хвиля - номер атаки.<br />
          🎯 Рахунок - кількість знищених цілей.
        </div>
        <button id="donateZSU" class="donate-btn">
          💙 Донат на ЗСУ
        </button>
        <button id="donateProject" class="donate-btn">
          💛 Підтримати проєкт
        </button>
        <div class="footer-links">
          <a href="https://t.me/dronefall" target="_blank" rel="noopener noreferrer">
            <img src="assets/telegram-icon.png" alt="Телеграм" />
          </a>
          <a href="https://tiktok.com/@eurogames7" target="_blank" rel="noopener noreferrer">
            <img src="assets/tiktok-logo.png" alt="ТікТок" />
          </a>
        </div>

        <div id="loading" role="status" aria-live="polite">
          <div id="loadingText" aria-live="polite">Завантаження: 0%</div>
          <div id="loadingBar"><div id="loadingProgress"></div></div>
        </div>
      </div>
    </div>

    <div id="pvoMenu"></div>

    <div id="alarmIndicator">
      <div class="alarm-dot"></div>
      ⚠️ Повторні пуски
    </div>

    <script type="module" src="/src/boot.js"></script>
    <script type="module" src="/src/main.js"></script>
  </body>
</html>
